
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Classical statistical mechanics &#8212; Equilibrium Statistical Physics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ensemble-Theory-1';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/LLPS.webp" class="logo__image only-light" alt="Equilibrium Statistical Physics - Home"/>
    <img src="_static/LLPS.webp" class="logo__image only-dark pst-js-only" alt="Equilibrium Statistical Physics - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Lecture Notes on Equilibrium Statistical Mechanics (Physics 211)
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Course-Info-211-2025.html">Course Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Quick Summary of Statistical Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Coin-flipping.html">Probability and information entropy</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/Hallatscheklab/StatPhys/blob/master/Ensemble-Theory-1.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Hallatscheklab/StatPhys" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Hallatscheklab/StatPhys/issues/new?title=Issue%20on%20page%20%2FEnsemble-Theory-1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Ensemble-Theory-1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Classical statistical mechanics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#closed-systems-microcanonical-ensemble">Closed systems – microcanonical ensemble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ergodicity">Ergodicity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#entropy">Entropy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-equilibrium">Thermal equilibrium</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-exchange-canonical-ensemble">Energy exchange – canonical ensemble</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="classical-statistical-mechanics">
<h1>Classical statistical mechanics<a class="headerlink" href="#classical-statistical-mechanics" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Kardar Ch. 4</p></li>
<li><p>We skipped Ch. 1 because Thermo is a prerequisite for this class, and its principles will soon be rederived from a molecular viewpoint</p></li>
<li><p>We also skipped Ch. 3, though some of it will come back before we venture into quantum stat mech</p></li>
</ul>
<p><strong>Why do we need statistical mechanics?</strong></p>
<ul class="simple">
<li><p>Fluctuations cause condensed matter systems to reside in a multitude of microstates, rather than adopting well defined internal energy minima,</p></li>
<li><p>The set of “typical” microstates of a large system is the thermal equilibrium. Once kicked out of equilibrium, a large system quickly settles back into the same set of microstates.</p></li>
<li><p>The description of large systems at thermal equilibrium is the focus of equilibrium statistical physics.</p></li>
<li><p>Note that living systems consume energy to drive irreversible processes and stay away from thermal equilibrium. Nevertheless, they often show seemingly random fluctuations that can even dominate their behavior. It is active topic research how to extend statistical mechanics to describe such active systems far from equilibrium.</p></li>
</ul>
<section id="closed-systems-microcanonical-ensemble">
<h2>Closed systems – microcanonical ensemble<a class="headerlink" href="#closed-systems-microcanonical-ensemble" title="Link to this heading">#</a></h2>
<p><strong>Basic principle of statistical mechanics:</strong> In an <em>isolated</em> system, all <em>allowed</em> <em>microstates</em> are equally likely.</p>
<ul class="simple">
<li><p>An “isolated” system does not transfer energy, matter, volume or other conserved quantities outside its boundaries. A “closed” system can exchange energy, but not matter. “Open” systems typically exchange energy, matter and volume. Example: Biological systems (cells, organisms).</p></li>
<li><p>In classical physics (=all we care for now), a “microstate” of a system of <span class="math notranslate nohighlight">\(N\)</span> particles is a specific point <span class="math notranslate nohighlight">\(\mu=\{\vec r, \vec p\}\)</span> in <span class="math notranslate nohighlight">\(6N\)</span>–dimensional phase space. It described the positions <span class="math notranslate nohighlight">\(\vec r\)</span> and momenta <span class="math notranslate nohighlight">\(\vec p\)</span> of all particles of the system.</p></li>
<li><p>All “allowed” microstates have the same energy and <em>generalized coordinates</em> <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>, which for a particle system typically consist of the volume of the container and the number of particles, i.e. <span class="math notranslate nohighlight">\(\mathbf{x}=(V,N)\)</span>.</p></li>
<li><p>But the type of generalized coordinates we have to consider depends on the problem.</p>
<ul>
<li><p>If the system consists of different particle types, we need <span class="math notranslate nohighlight">\(\mathbf{x}=(V,N_1,N_2, \dots)\)</span>.</p></li>
<li><p>If we consider magnets, the total magnetization <span class="math notranslate nohighlight">\(M\)</span> is included</p></li>
<li><p>If we consider polymers, the length <span class="math notranslate nohighlight">\(L\)</span> of the polymer is used.</p></li>
<li><p>generalized coordinates are always <em>extensive</em>!</p></li>
</ul>
</li>
</ul>
<img src="https://github.com/Hallatscheklab/SoftMatter22-23/blob/main/source/notebooks/L1/img/trail-of-bright-light-in-box-460688633-5966b3605f9b5816183316bb.webp?raw=1" alt="systems" name="systems" class="bg-primary mb-1" width="500px"><p>Then, we can mathematize the basic principle by stating that the equilibrium distribution <span class="math notranslate nohighlight">\(P_{E,\mathbf{x}}(\mu)\)</span> to observe a particular state <span class="math notranslate nohighlight">\(\mu\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[P_{E,\mathbf{x}}(\mu)d\mu=\frac{\delta(E-H(\mu))}{\Omega(E,\mathbf{x})}d\mu \qquad (\text{micro-canonical ensemble})\]</div>
<p>where the normalization constant</p>
<div class="math notranslate nohighlight">
\[\Omega(E,\mathbf{x})\equiv \int \delta(E-H(\mu))\;d\mu \]</div>
<p>characterizes the total number of microstates {<span class="math notranslate nohighlight">\(\mu\)</span>} with <span class="math notranslate nohighlight">\(H(\mu)=E\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}_\mu=\mathbf{x}\)</span>.</p>
<p>Note that for discrete set of micro states, e.g., when discussing Ising spins <span class="math notranslate nohighlight">\(\sigma_i=\pm 1\)</span>, replace the integral by a sum, <span class="math notranslate nohighlight">\(\int d\mu\rightarrow \sum_{\mu}\)</span>, and the Dirac delta function by a Kronecker delta, <span class="math notranslate nohighlight">\(\delta(E-H(\mu))\rightarrow \delta_{E,H(\mu)}\)</span></p>
<section id="ergodicity">
<h3>Ergodicity<a class="headerlink" href="#ergodicity" title="Link to this heading">#</a></h3>
<p>One can imagine measuring expectation values <span class="math notranslate nohighlight">\(\langle f(\mu)\)</span> in two ways: 1. Follow a given system for a very long time, and determine the time average of <span class="math notranslate nohighlight">\(f\)</span>. 2. Determine the <em>ensemble</em> average of <span class="math notranslate nohighlight">\(f\)</span> over a very large number of system states drawn from the <span class="math notranslate nohighlight">\(P_{E,\mathbf{x}}\)</span>. Our Basic Principles implies that, in the limit, both results give the same answer. Mathematically,</p>
<div class="math notranslate nohighlight" id="equation-ergodic-hypothesis">
<span class="eqno">()<a class="headerlink" href="#equation-ergodic-hypothesis" title="Link to this equation">#</a></span>\[ \langle f\rangle_{E,\mathbf{x}}=\lim_{T\to\infty}\frac 1T \int_0^Tf(\mu(t)) dt=\int d\mu P_{E,\mathbf{x}}(\mu) f(\mu) \]</div>
<p>The celebrated <a class="reference external" href="https://en.wikipedia.org/wiki/Ergodic_theory#:~:text=The%20concepts%20of%20ergodicity%20and,average%20over%20the%20entire%20space.">ergodicity theorem</a> explains why this equality and, thus, our Basic Principle, is to be expected for typical systems undergoing volume conserving Hamiltonian dynamics (see later in the course). Macroscopic systems, such as ferromagnetic systems below the Curie temperature, can demonstrate ergodicity breaking, where they do not explore all possible states as predicted by the ergodic hypothesis. This results in phenomena like spontaneous magnetization, a form of spontaneous symmetry breaking. Similarly, complex disordered systems like spin glasses and conventional glasses, like window glasses, exhibit more intricate forms of ergodicity breaking. These systems can appear solid over short timescales, like seconds or hours, due to their positive shear modulus, but over very long periods, like millennia, they behave more like liquids, displaying multiple time scales and intermediate plateaus in behavior.</p>
</section>
<section id="entropy">
<h3>Entropy<a class="headerlink" href="#entropy" title="Link to this heading">#</a></h3>
<p>We can also argue for the micro-canonical ensemble to be the most unbiased (maximum entropy) distribution subject to the constraints <span class="math notranslate nohighlight">\(H(\mu)=E\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}_\mu=\mathbf{x}\)</span>. Recall that the entropy of a discrete probability distribution is <span class="math notranslate nohighlight">\(S=-\sum_i P_i \ln(P_i)\)</span>, which is maximized for <span class="math notranslate nohighlight">\(P_i=\)</span>const.<span class="math notranslate nohighlight">\(=\Omega^{-1}(E,\mathbf{x})\)</span>. In that case, <span class="math notranslate nohighlight">\(S=\ln(\Omega(E,\mathbf{x}))\)</span>.</p>
<p>Historically, Boltzmann defined entropy to be the dimensionful quantity</p>
<div class="math notranslate nohighlight">
\[S\equiv {\rm k_B}\ln(\Omega)\]</div>
<p>with <span class="math notranslate nohighlight">\({\rm k_B}\sim 1.38×10^{−23} {\rm J⋅K^{−1}}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a continuous phase space, <span class="math notranslate nohighlight">\(\Omega\)</span> is dimensionful. E.g. for an <span class="math notranslate nohighlight">\(N\)</span>-particle system, <span class="math notranslate nohighlight">\(\Omega\)</span> has units of phase space volume per energy,</p>
<div class="math notranslate nohighlight">
\[[\Omega]= ([p][q])^{3N} [E]^{-1}\;.\]</div>
<p>To obtain a sensible definition of an <em>absolute</em> entropy, we should discretize phase space and energy to measure <span class="math notranslate nohighlight">\(\Omega\)</span> in some characteristic unit <span class="math notranslate nohighlight">\([\hat \Omega]\)</span>, so that <span class="math notranslate nohighlight">\(S={\rm k_B}\ln(\Omega/[\hat \Omega])\)</span>. That happens automatically in quantum mechanics, which provides natural units for phase space volume in terms of Planck’s constant (<span class="math notranslate nohighlight">\(h^{3N}\)</span>) and ensures that energy levels are discretized.</p>
<p>If we want to define an absolute entropy in classical statistical mechanics, Planck’s constant is often borrowed from quantum mechanics. However, normally, classical statistical mechanics only cares about entropy differences, <span class="math notranslate nohighlight">\(S(E_1)-S(E_2)={\rm k_B}\ln(\Omega_1/\Omega_2)\)</span>, for which the discretization issue does not arise.</p>
</div>
</section>
<section id="thermal-equilibrium">
<h3>Thermal equilibrium<a class="headerlink" href="#thermal-equilibrium" title="Link to this heading">#</a></h3>
<p>Consider an isolated system <span class="math notranslate nohighlight">\({\mu, E, \bf{x}}\)</span> consisting of two subsystem in contact so that they can exchange energy,</p>
<p><img alt="" src="_images/micro-can-compound-system.jpg" /></p>
<div class="math notranslate nohighlight">
\[\mu=\mu_1 \otimes \mu_2\]</div>
<div class="math notranslate nohighlight">
\[E=E_1+E_2 +\text{higher order surface contribution}\]</div>
<p>N.B.:</p>
<ul class="simple">
<li><p>E_1 and E_2 are extensive, they grow linearly with the subsystem sizes</p></li>
<li><p>the surface contribution is intensive if the interactions are local.</p></li>
<li><p>Therefore, the surface contribution is negligible as subsystem sizes are send to infinity (thermodynamic limit)</p></li>
</ul>
<p>The probability of observing a particular state <span class="math notranslate nohighlight">\(\mu\)</span> of the compound system is, therefore, given by the microcanonical expression</p>
<div class="math notranslate nohighlight">
\[P_{E,\mathbf{x}}(\mu)=\frac{\delta(E-H(\mu))}{\Omega(E,\mathbf{x})} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[H(\mu)= H_1(\mu_1)+H_2(\mu_2)+\text{h.o.t. surface constribution}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\Omega(E, \bf{x}) &amp; =\int d \mu_{1} d \mu_{2} \delta(E-H(\mu)) \\
&amp; =\int d E_{1} \Omega_{1}\left(E_{1}, \bf{x}_1\right) \Omega_{2}\left(E-E_{1}, \bf{x}_2\right)
\end{aligned}
\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-x">
<span class="eqno">()<a class="headerlink" href="#equation-x" title="Link to this equation">#</a></span>\[
e^{S(E) / k_{B}} =\int d E_{1} e^{\left[S_{1}\left(E_{1}, \bf{x}_1\right)+S\left(E-E_{1}, \bf{x}_2\right)\right] / k_{B}}
\]</div>
<p>(compound entropy)</p>
<p><span class="math notranslate nohighlight">\(S_{1}, S_{2}\)</span> extensive and, so,</p>
<div class="math notranslate nohighlight">
\[
S(E,\bf{x})=N s_{1}\left(\frac{E_{1}}{N},\frac{\bf{x}_1}N\right)+N s_{2}\left(\frac{E-E_{1}}{N},\frac{\bf{x}_2}N\right)
\]</div>
<p>where <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_2\)</span> are entropies per particle, which approach a constant as we increase the system sizes.</p>
<p>Thus, as <span class="math notranslate nohighlight">\(N \rightarrow \infty\)</span>, the integral in <a class="reference internal" href="#equation-x">()</a> is dominated by the maximum of the integrand, so that</p>
<div class="math notranslate nohighlight">
\[
S(E,\bf{x}) \to S_{1}\left(E_{1}^{*},\bf{x}_1\right)+S_{2}\left(E_{2}^{*}=E-E_{1},\bf{x}_2\right)
\]</div>
<p>where the position of the maximum is obtained by extremizing w.r.t. <span class="math notranslate nohighlight">\(E_1\)</span>, resulting in</p>
<div class="math notranslate nohighlight">
\[
\left.\frac{\partial S_{1}(E_1^*)}{\partial E_{1}}\right|_{x_{1}}=\left.\frac{\partial S_{2}(E_2^*=E-E_1^*)}{\partial E_{2}}\right|_{x_{2}}
\]</div>
<img src="figures/thermalization-microcanonical.jpg" alt="drawing" width="200"/><p>Employing the <strong>thermodynamic definition of temperature</strong></p>
<div class="math notranslate nohighlight">
\[\frac{1}{T}=\left.\frac{\partial S}{\partial E}\right|_{\bf{x}}\;,\]</div>
<p>the maximum <span class="math notranslate nohighlight">\(E_1^{*}\)</span> is set by</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{T_{1}}=\frac{1}{T_{2}}\;.
\]</div>
<p>Note:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_1\)</span> (or <span class="math notranslate nohighlight">\(E_2=E-E_1\)</span>) adjusts itself so as to maximize <span class="math notranslate nohighlight">\(S\)</span>.</p></li>
<li><p>When <span class="math notranslate nohighlight">\(S\)</span> is maximized, the temperature of both compartments are identical</p></li>
</ul>
<p><strong>Second law:</strong> If we prepare an initial condition where <span class="math notranslate nohighlight">\(E_{1} \neq E_{1}^{*}\)</span>, by ergedicity <span class="math notranslate nohighlight">\(E_{1} \rightarrow E_{1}^{*}\)</span> at long times because <span class="math notranslate nohighlight">\(E_{1}^{*}\)</span> is <em>much more likely</em> (sketch). The entropy increases,</p>
<div class="math notranslate nohighlight">
\[
\Delta S=S_{1}\left(E_{1}^{*}\right)+S_{2}\left(E_{2}^{*}\right)-S_1\left(E_{1}\right)-S_2\left(E_{2}\right) \geq 0
\]</div>
<p>which, to first order in <span class="math notranslate nohighlight">\(E_{1}^{*}-E_{1}=\delta E_{1}\)</span>, implies</p>
<div class="math notranslate nohighlight">
\[
\left(\frac{1}{T_{1}}-\frac{1}{T_{2}}\right) \delta E_{1} \geqslant 0 \;,
\]</div>
<p>i.e., <span class="math notranslate nohighlight">\(T_2&gt;T_1\)</span> if <span class="math notranslate nohighlight">\(\delta E_1&gt;0\)</span> and <span class="math notranslate nohighlight">\(T_1&gt;T_2\)</span> if <span class="math notranslate nohighlight">\(\delta E_1&lt;0\)</span>.</p>
<p>Thus, <strong>energy always flows from hot to cold.</strong></p>
<p><strong>Stability:</strong> Since the point <span class="math notranslate nohighlight">\(\left(E_{1}^{*} E_{2}^{*}\right)\)</span> is a maximum of <span class="math notranslate nohighlight">\(S\left(E_{1}^{*}\right)+S_{2}\left(E-E_{1}^{*}\right)\)</span> we must have</p>
<div class="math notranslate nohighlight">
\[
\left.\frac{\partial^{2} S_{1}}{\partial E^{2}}\right|_{x_{1}}+\left.\frac{\partial^{2} S_{2}}{\partial E_{2}^{2}}\right|_{x_{2}} \leq 0
\]</div>
<p>Suppose both systems are identical, <span class="math notranslate nohighlight">\(S_{1}=S_{2}\)</span></p>
<div class="math notranslate nohighlight">
\[
\left.\Rightarrow \partial_{E}^{2} S\right|_{x} \leq 0 \Rightarrow \text { \bf S is concave}
\]</div>
<p>Also, since <span class="math notranslate nohighlight">\(\left.\partial_{E} S\right|_{x}=T^{-1}\)</span>, we have <span class="math notranslate nohighlight">\(\left.\frac{\partial E}{\partial T}\right|_{x} \geq 0\)</span>.</p>
<p>I.e., the <strong>specific heat</strong> <span class="math notranslate nohighlight">\(C_{x}\equiv \left.\frac{\partial E}{\partial T}\right|_{x}\)</span> is <strong>non-negative</strong>.</p>
<p><strong>Work and First Law</strong></p>
<p>Thus far, we kept the generalized coordinates fixed and studied the redistribution of energy. When we manipulate the generalized coordinates, we do work on the system.</p>
<p>To analyze this situation, consider first changing <span class="math notranslate nohighlight">\(\bf{x}\to \bf{x}+\bf{\delta x}\)</span> in a slow, <em>reversible</em>, manner. (I.e. we can return to the initial state by reversing the externally applied forces <span class="math notranslate nohighlight">\(\bf{J}\)</span>.)</p>
<p>Then, the energy will change, <span class="math notranslate nohighlight">\(E\to E+\bf{J} \cdot \bf{\delta x}\)</span>, and so</p>
<div class="math notranslate nohighlight">
\[\delta S=S(E+\bf{J} \cdot \bf{dx},\bf{x}+\bf{\delta x})-S(E,\bf{x})=\left. \frac{\partial S}{\partial E}\right|_x(\bf{J} \cdot \bf{\delta x})+\left.\frac{\partial S}{\partial x}\right|_E \bf{\delta x}\geq 0\]</div>
<p>For a reversible dynamics, we must have the equal sign, i.e.</p>
<div class="math notranslate nohighlight">
\[
\left.\Rightarrow \frac{\partial S}{\partial x_{i}}\right|_{E, x_{j\neq i}}=-\frac{J_{i}}{T}
\]</div>
<p>Thus, for a reversible transformation, the change in entropy becomes</p>
<div class="math notranslate nohighlight">
\[
\Rightarrow \delta S=\frac{d E}{T}-\frac{\bf{J} \cdot \bf{\delta x}}{T} \]</div>
<p>which implies the <strong>first law of thermodynamics</strong>:</p>
<div class="math notranslate nohighlight">
\[
\Rightarrow dE=\underbrace{T d S}_{d Q}+\underbrace{\bf{J} \cdot \bf{\delta x}}_{dW}
\]</div>
</section>
</section>
<section id="energy-exchange-canonical-ensemble">
<h2>Energy exchange – canonical ensemble<a class="headerlink" href="#energy-exchange-canonical-ensemble" title="Link to this heading">#</a></h2>
<p>Most soft matter systems are closed but not isolated - they trade energy and volume with the environment (a.k.a. <em>reservoir</em>, <em>bath</em>, <em>sorroundings</em>). What can we say about <span class="math notranslate nohighlight">\(P(\nu_s)\)</span> in those cases?</p>
<p>The combination of System (index s) and Bath (index b) forms an <em>isolated</em> system with fixed <span class="math notranslate nohighlight">\(E\)</span>, <span class="math notranslate nohighlight">\(V\)</span>, <span class="math notranslate nohighlight">\(N\)</span>. We can therefore apply our “Basic Principle” to conclude</p>
<ul class="simple">
<li><p>All states with <span class="math notranslate nohighlight">\(E_s+E_r=E\)</span> are equally likely.</p></li>
<li><p>To reach a high energy state, s has to “steal” energy from b.
What’s the probability <span class="math notranslate nohighlight">\(P(\nu_s)\)</span> of system state <span class="math notranslate nohighlight">\(\nu_s\)</span> irrespective of the state of the bath?</p></li>
</ul>
<div class="math notranslate nohighlight">
\[P(\nu_s)=\sum_{\nu_r} P(\nu_s,\nu_r)=\frac{\Omega_r(E-E_s)}{\Omega(E,V,N)}\]</div>
<div class="math notranslate nohighlight">
\[\boxed{\rightarrow P(\nu_s)\propto \Omega_r(E-E_s)}\]</div>
<p>Note that <strong>the multiplicity of the bath alone controls the state of the system.</strong> I.e. the more states are available to the bath the more likely a given microstate of the system is. Energy exchange is important only in sofar as it modifies the number of states available to the bath and the system.</p>
<p>The multiplicity of microstates grows exponentially with its parameters. This can be most easily demonstrated for particle numbers (see example below) but generally holds also for energy and volume. Therefore, it makes sense to introduce the logarithm of the multiplicity. That’s what Ludwig Boltzmann did by introducing what’s now called the <strong>Boltzmann entropy:</strong> $<span class="math notranslate nohighlight">\( S\equiv k_\mathrm{B} \ln \Omega \qquad k_\mathrm{B}=1.38064852 × 10^{-23} {\rm J/ K}.\)</span>$</p>
<p>Using the Boltzmann entropy, we can write $<span class="math notranslate nohighlight">\(P(\nu_s)\propto e^{k_\mathrm{B}^{-1}S_r(E-E_s)}.\)</span>$
When the bath is very big (thermodynamic limit), we can Taylor expand the exponent,</p>
<div class="math notranslate nohighlight">
\[ S_s(E-E_s)=S_r(E)+\left(\frac{\partial S}{\partial E}\right)_{V,N}(-E_s)+\cdots \]</div>
<p>Inserting above yields</p>
<div class="math notranslate nohighlight">
\[\boxed{P(\nu_s)\propto \exp\left[\text{const.}-k_B^{-1}\left(\frac{\partial S_r}{\partial E}\right)_{V, N}E_s\right]\propto e^{-b E_s}\;,\qquad \text{where } b\equiv k_B^{-1}\left(\frac{\partial S_r}{\partial E}\right)_{V, N}\;.} \]</div>
<p>The factor <span class="math notranslate nohighlight">\(e^{-b E_s}\)</span> is the <strong>Boltzmann factor</strong>, if we identify <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(\beta_r\equiv (k_\mathrm{B} T_r)^{-1}\)</span>.</p>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[\beta_r\equiv \left(\frac{\partial \ln \Omega_r}{\partial E}\right)_{V, N}=\frac 1{k_\mathrm{B}} \left(\frac{\partial S_r}{\partial E}\right)_{V, N}.\]</div>
<p>Equivalently,</p>
<div class="math notranslate nohighlight">
\[\boxed{T_r\equiv \left(\frac{\partial S_r}{\partial E}\right)_{V, N}^{-1}}\]</div>
<p>is the  <strong>thermodynamic definition</strong> of the temperature of the bath.</p>
<p><strong>Implication: The ratio of probabilities of two microstates is given by the ratio of their Boltzmann factors</strong></p>
<div class="math notranslate nohighlight">
\[\frac{P(\nu_s^{(1)})}{P(\nu_s^{(2)})}=e^{-\frac{E_s^{(2)}-E_s^{(1)}}{k_\mathrm{B} T_r}}=e^{-\frac{\Delta E}{k_\mathrm{B} T_r}}\]</div>
<div class="alert alert-info">
<p><strong>Example: Barometric height formula.</strong></p>
<p>Consider a constant gravitational force <span class="math notranslate nohighlight">\(F=-mg\)</span> along the <span class="math notranslate nohighlight">\(z\)</span>-direction such that the potential energy is given by <span class="math notranslate nohighlight">\(E=mgz+E_0\)</span> where <span class="math notranslate nohighlight">\(E_0\)</span> is the energy at ground level. For simplicity, we set <span class="math notranslate nohighlight">\(E_0=0\)</span>.</p>
<p>The potential energy difference due to a height difference <span class="math notranslate nohighlight">\(\Delta z\)</span> is given by <span class="math notranslate nohighlight">\(\Delta E = m g \Delta z\)</span>. Therefore, the ratio of the probabilities to find a particle at a given position compared to a position elevated by a height <span class="math notranslate nohighlight">\(\Delta z\)</span> is given by $<span class="math notranslate nohighlight">\(\frac{P(\nu_s^{(1)})}{P(\nu_s^{(2)})}=\exp\left(-\frac{\Delta z}{\lambda}\right), \qquad \text{in terms of the &quot;scale height&quot;} \lambda\equiv \frac{k_B T}{m g}\approx 8 \text{km}.\)</span>$ Thus, increasing your elevation by 8 km approximately leads to an e-fold reduction of the air density. (“approximately”, because (i) the temperature changes with height, (ii) molecules interact and (ii) the atmosphere is not in equilibrium).</p>
<p>So far, we just cared about ratios of probabilities. In general it is much harder to compute absolute probabilities, which requires computing a normalization constant – the partition function. In the present one-dimensional case, however, we can do it easily: The probability <span class="math notranslate nohighlight">\(p(z)\)</span> for finding the particle at position <span class="math notranslate nohighlight">\(z\)</span> is given by
<span class="math notranslate nohighlight">\(p(z)=\frac{1}{\lambda}\exp\left( -\frac{z}{\lambda}\right)\)</span>, which is properly normalized, <span class="math notranslate nohighlight">\(\int_0^\infty p(z)=1\)</span>.</p>
</div>
<div class="alert alert-info">
<p><strong>Example: Two-level-system</strong></p>
<p>As another frequent application of Boltzmann’s law are state populations of two state systems, as we find them frequently in physics, e.g., for spin systems. Such two level spin systems are, for example, very important for nuclear magnetic resonance (NMR), which is an important tool to study the structure and dynamics of soft matter.</p>
<p><img alt="Two Level" src="_images/two_level.png" /></p>
<p>Consider the image above, where a single energy level at zero magnetic field (<span class="math notranslate nohighlight">\(B=0\)</span>) splits into two energy levels due to the interaction of a proton spin (red arrow) with the external magnetic field.</p>
<p>The magnetic moment of the proton spin may take two expectation values in the magnetic field, which are characterized by the magnetic quantum number <span class="math notranslate nohighlight">\(m_Z=\pm 1/2\)</span>. The magnetic moment projected along the magnetic field direction is then</p>
<div class="math notranslate nohighlight">
\[\mu_Z=\gamma m_Z \hbar\]</div>
<p>and the energy of the states</p>
<div class="math notranslate nohighlight">
\[E(m_Z)=-\mu_Z B=-\gamma m_Z \hbar B\]</div>
<p>with <span class="math notranslate nohighlight">\(\gamma=2.675222005\times 10^{8}\; \mathrm{s}^{-1} \mathrm{T}^{-1}\)</span> being the gyromagnetic ratio of the proton.
The energy difference for a nonzero magnetic field is therefore given by</p>
<div class="math notranslate nohighlight">
\[\Delta E=\gamma \hbar B=\hbar \omega_\mathrm{L}\]</div>
<p>which results for a magnetic field of <span class="math notranslate nohighlight">\(B=1\; \mathrm{T}\)</span> in <span class="math notranslate nohighlight">\(\Delta E\approx 1.76\times 10^{-7}\;{\rm eV}\)</span> or a Larmor frequency of <span class="math notranslate nohighlight">\(\omega_\mathrm{L}=42\; {\rm MHz}\)</span>. This energy difference is almost negligible as compared to the thermal energy at room temperature <span class="math notranslate nohighlight">\(k_\mathrm{B}T=2.6\times 10^{-2}\;{\rm eV}\)</span>. Yet, this small energy difference is used to give the contrast in NMR and related techniques such as MRI.</p>
<p>Using the Boltzmann distribution we can now calculate the ratio of the population of spins in the lower or excited state</p>
<div class="math notranslate nohighlight">
\[\frac{N_{-\frac{1}{2}}}{N_{+\frac{1}{2}}}=\exp\left (-\frac{\Delta E}{k_\mathrm{B} T} \right )\]</div>
<p>which is very close to one:</p>
<div class="math notranslate nohighlight">
\[\frac{N_{-\frac{1}{2}}}{N_{+\frac{1}{2}}}=0.99999332.\]</div>
<p>If you consider now a volume of <span class="math notranslate nohighlight">\(V=1\;{\rm {\mu m}}^3\)</span> water, then you would roughly have about <span class="math notranslate nohighlight">\(N=6.7\times 10^{19}\)</span> protons. This then means that the excess number of protons in the excited state is just <span class="math notranslate nohighlight">\(N_{+\frac{1}{2}}-N_{-\frac{1}{2}}=4.5\times 10^{12}\)</span>, which is extremely low. Thus, to detect something in NMR or MRI, a certain number of protons in the volume is required.</p>
</div></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#closed-systems-microcanonical-ensemble">Closed systems – microcanonical ensemble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ergodicity">Ergodicity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#entropy">Entropy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-equilibrium">Thermal equilibrium</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-exchange-canonical-ensemble">Energy exchange – canonical ensemble</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Oskar Hallatschek
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>